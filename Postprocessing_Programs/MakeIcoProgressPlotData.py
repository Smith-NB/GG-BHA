#!/usr/bin/env python3
import matplotlib.pyplot as plt
import os, sys

def get_ico():
	return Atoms(symbols='Ne38', pbc=np.array([False, False, False]), 
			cell=np.array(
				[[23.8204175 ,  0.        ,  0.        ],
				[ 0.        , 23.8165006 ,  0.        ],
				[ 0.        ,  0.        , 24.02128846]]),
			positions=np.array(
				[[12.85948753, 10.69097678, 12.3799274 ],
				[13.17176121, 11.59623236, 11.80248214],
				[11.74885165, 10.58451662, 12.30493724],
				[12.09969487, 13.87875804, 11.23325141],
				[13.47263124, 12.4996623 , 11.21621597],
				[11.69986762, 11.83162308, 11.39275531],
				[11.57588959, 12.45372441, 12.29433616],
				[13.03514283, 13.41592337, 11.68120196],
				[12.34205285, 10.94844925, 11.43310607],
				[10.75066024, 12.79418795, 10.64293929],
				[ 9.75432931, 12.21107284, 12.06138069],
				[10.14002718, 11.35741173, 12.70359915],
				[12.2140628 , 10.99407666, 13.23946151],
				[10.6103671 , 12.35513591, 12.74305364],
				[12.55480531, 12.9619056 , 10.77534487],
				[10.06933171, 13.1402397 , 11.46366323],
				[11.63071351, 13.41107135, 10.33405754],
				[11.72759159, 12.30863908, 10.41004667],
				[10.85171597, 11.68583495, 10.71938681],
				[12.07532785, 13.39667868, 12.22584144],
				[10.74795486, 12.30485593, 11.62666914],
				[13.4251877 , 12.55236837, 12.33074913],
				[11.56242713, 11.88400414, 13.1990781 ],
				[12.4677958 , 12.52770893, 12.87943247],
				[12.64869442, 11.85290794, 10.85117754],
				[10.95882297, 13.77272804, 11.14948765],
				[11.08614066, 10.889218  , 13.1566698 ],
				[11.23145915, 10.84524539, 11.35162082],
				[13.11386271, 11.63380583, 12.92170593],
				[11.82507537, 11.20332272, 10.48221145],
				[10.92737845, 13.29005472, 12.14160354],
				[ 9.87917482, 12.16565145, 10.95257334],
				[12.20507024, 11.58384394, 12.32452175],
				[10.2525476 , 11.32494538, 11.58840233],
				[11.60428279, 12.91373344, 11.32426869],
				[12.50483534, 12.46813871, 11.7555777 ],
				[10.63856653, 10.48456153, 12.216977  ],
				[11.11925368, 11.48293143, 12.24486263]]))

sims = []

if os.path.exists("sim_to_GM.txt"):
	exit()
else:
	from ase.io.trajectory import Trajectory
	from BHA.T_SCM_Methods import get_CNA_profile, get_CNA_similarity
	import numpy as np
	traj = Trajectory("local_minima.traj")
	ico = get_ico()
	ico_CNA = get_CNA_profile((ico, [1.3549]))
	x = []
	i = 0
	for cluster in traj:
		cna = get_CNA_profile((cluster, [1.3549]))
		sims.append(get_CNA_similarity(GM_CNA, cna))
		i += 1

	np.savetxt("sim_to_GM.txt", sims, fmt="%f")
