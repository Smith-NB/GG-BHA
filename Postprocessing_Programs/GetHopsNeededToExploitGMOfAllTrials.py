#!/usr/bin/env python3

import os, sys
import numpy as np
import scipy.stats

def mean_confidence_interval(data, confidence=0.95):
    a = 1.0 * np.array(data)
    n = len(a)
    m, se = np.mean(a), scipy.stats.sem(a)
    ci = se * scipy.stats.t.ppf((1 + confidence) / 2., n-1)
    return m, ci

"""
print("Minimum similarity to GM: ")
try:
	min_sim = float(input())
except ValueError:
	print("ValueError: Must input an int or float")
	sys.exit(2)
"""
trials_checked = 0
total_hop_count = 0
path = os.getcwd()
for i in range(40, 100, 10):
	min_sim = i
	total_exploiting_steps = []
	for root, dirs, files in os.walk(path, topdown=True):
		dirs.sort()
		#dirs.reverse()
		for d in dirs:
			trial_exploiting_steps = 0
			if d.startswith('Trial') and d.replace('Trial', '').isdigit() and int(d.replace('Trial', '')) > 0 and int(d.replace('Trial', '')) <= 100:
				trials_checked += 1
				if os.path.exists(root + "/" + d + "/sim_to_GM.txt"):
					#f = open(root + "/" + d + "/sim_to_GM.txt", "r")
					for line in reversed(list(open(root + "/" + d + "/sim_to_GM.txt", "r"))):
						if float(line) > i:
							trial_exploiting_steps += 1
						else:
							total_exploiting_steps.append(trial_exploiting_steps)
							break
					#f.close()
				else:
					pass

				###########
				sys.stdout.write("\r                                                                  ")
				sys.stdout.flush()
				sys.stdout.write("\rChecked " + str(d) + ".")
				sys.stdout.flush()
				###########	
				
			
		break

	#print("\nThis program is set to only check the first 100 trials.")
	print()
	print(min_sim)
	print(mean_confidence_interval(total_exploiting_steps))
	print('\n')
